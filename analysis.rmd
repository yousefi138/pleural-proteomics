---
title: "Pleural proteomics of pleural infection"
subtitle: "Results from Olink Target 96 Inflammation panel "
date: "`r format(Sys.time(), '%d %B %Y')`"
author: Paul Yousefi
output:
  html_document:
    css: docs/style.css
    toc: true
    highlight: tango
---

```{r setoptions, eval = TRUE, echo = FALSE}
knitr::opts_chunk$set(
comment = ">",
error = FALSE,
tidy = FALSE,
echo = F, 
warning = FALSE, 
message = FALSE,
cache=FALSE)
```

```{r call_source, echo = F}
path <- "."
sourcecode <- grep("analysis.r$", 
	list.files(path), value = T)
read_chunk(file.path(path, sourcecode))
```

# Pleural proteins

```{r globals, results = 'hide', echo=F }
```

```{r load.data, echo=F}
```

Of the 265 samples run, `r ncol(prot.mat)` passed the default qc performed in the `metaboprep` package.

For the moment, all `r nrow(prot.mat)` measured proteins have been retained for analysis.

See `project_metaboprep_qc_report.html` for full details


# Phenotype information

The below phenotypic information was available on participants:

```{r pheno}
```

Participant age, sex, and infection status are shown below. As is the `final.diagnosis.1` variable that was used to derive the infection status variable, `infect`.

```{r tab}
```

# Protein-wide associations

Phenotypic characteristics of participants described in [Phenotype information](#phenotype-information) were examined for association pleural protein abundances ([Pleural proteins](#pleural-proteins))

## Models

The formulae of linear models examined are shown in the table below:

```{r models}
```

## QQ plots

```{r qq}
```

## Volcano plots

```{r volcano}
```

## Hit counts per model

Number of bonferroni (p< 0.05/92) and fdr adjusted (fdr p < 0.05) hits per model

```{r hit.counts}
```

## Top hits

```{r top}
```

```{r, results='asis'}
top
```

## Gene-annotated volcano plots

```{r vol.lab}
```
